from xml.dom.minidom import parse, parseString
import re

trace = u"<trace id=\"1291\" timestamp=\"129399178403095479\">\n"
trace = trace +u"<class type=\"registry\" return=\"0\" />\n"
trace = trace +u"<process pid=\"628\" ppid=\"464\" scontext=\"system_u:system_r:svchost_t\" name=\"\Device\HarddiskVolume2\Windows\System32\svchost.exe\" />\n"
trace = trace +u"<object name=\"\REGISTRY\MACHINE\SYSTEM\ControlSet001\Control\DeviceClasses\{53f56307-b6bf-11d0-94f2-00a0c91efb8b}\##?#IDE#DiskVBOX_HARDDISK___________________________1.0_____#5&33d1638a&0&0.0.0#{53f56307-b6bf-11d0-94f2-00a0c91efb8b}\#\Control\" tcontext=\"system_u:object_r:registry_t\" rights=\" KeyValuePartialInformation \" />\n"
#trace = trace +"<data>\n"
#trace = trace +"</data>\n"
# 
trace = trace +u"</trace>\n"

#trace = trace.decode("latin1","replace")

trace = trace.replace("&", "&amp;")

print(trace.decode("utf8"))
#try:
dom = parseString(trace.decode("utf8"))
#except:
#    print("Error ??")

for node in dom.getElementsByTagName("trace"):
    print("ID="+node.getAttribute("id"))

