import sys
from db2interface  import *


if __name__ == "__main__":

	dbconfig=dbconfig()
	db2 = dbinterface(dbconfig)
	boolean  = 0
	boolean1 = 0
	boolean2 = 0
	session = 0
	proto = ""
	scontext = ""
	for arg  in sys.argv:
		if boolean2 == 1:
			scontext = arg
			boolean2 = 0
		if boolean == 1:
			session = arg
			boolean = 0
		if arg == "-i":
			boolean = 1
		if arg == "-s":
			boolean2 = 1
		if boolean1 == 1:
			proto = arg			
			boolean1 = 0
		if arg == "-p":
			boolean1 = 1
	if boolean == 0:
		session = db2.newIdSession(1)

	if scontext == "" and  proto == "" and session > 0:
		db2.dumpIPSession(session)
	elif scontext != "" and proto == "" and session > 0:
		db2.dumpIPScontext(session, scontext)
	elif scontext == "" and proto != "" and session > 0:
		db2.dumpIPProto(session, proto)
	elif scontext != "" and proto != "" and session > 0:
		db2.dumpIPAccess(session, scontext,proto)
	else:
		print "syntaxe : -i id -p protocol  ou -i id -a access -s scontext ou -i id ou -i id -p protocol -s scontext" 
